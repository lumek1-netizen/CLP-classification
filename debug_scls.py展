import requests
import json

base_url = "https://chem.echa.europa.eu"
substance_id = "100.000.002"

session = requests.Session()
session.headers.update({
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
    "Accept": "application/json"
})

url_classes = f"{base_url}/api-cnl-inventory/harmonized/{substance_id}/classifications"
r = session.get(url_classes)
items = r.json().get("items", [])

for item in items:
    cid = item["classificationId"]
    status = item.get("status")
    prominent = item.get("isProminentFlag")
    celex = item.get("celexNumber")
    
    url_scl = f"{base_url}/api-cnl-inventory/harmonized/specific-concentration-limits/{cid}"
    r_scl = session.get(url_scl)
    scls_data = r_scl.json().get("items", [])
    
    print(f"--- CID {cid} (Status: {status}, Prominent: {prominent}, Celex: {celex}) ---")
    for sitem in scls_data:
        crange = sitem.get("concentrationRange")
        hazards = [h.get("hazardClassAndCategoryCode") for h in sitem.get("hazards", [])]
        print(f"  {crange}: {hazards}")
